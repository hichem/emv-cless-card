package com.boussettahichem.emvclesscard;

import android.util.Log;

public class TestCard {

	
	private static final String	TAG = "TestCard";
	
	byte select_DF[] = { 0x6F, 0x23, (byte)0x84, 0x0E, 0x32, 0x50, 0x41, 0x59, 0x2E, 0x53, 0x59, 0x53, 0x2E, 0x44, 0x44, 0x46,
			0x30, 0x31, (byte)0xA5, 0x11, (byte)0xBF, 0x0C, 0x0E, 0x61, 0x0C, 0x4F, 0x07, (byte)0xA0, 0x00, 0x00,
			0x00, 0x04, 0x10, 0x10, (byte)0x87, 0x01, 0x01, (byte)0x90, 0x00 } ;

	byte select_response[] = { 0x6F , 0x3A, (byte) 0x84, 0x07, (byte) 0xA0, 0x00 , 0x00 , 0x00 , 0x04 , 0x10 , 0x10 ,
				 (byte) 0xA5, 0x2F, 0x50, 0x0A, 0x4D, 0x41, 0x53 ,0x54, 0x45, 0x52, 0x43, 0x41, 0x52, 0x44,
				 (byte) 0x87, 0x01, 0x01, 0x5F, 0x2D, 0x02, 0x65, 0x6E, (byte) 0x9F,0x38, 0x06, (byte) 0x9F,
				 0x1D, 0x08, (byte)0x9F, 0x1A, 0x02, (byte) 0xBF, 0x0C, 0x0F, (byte) 0x9F, 0x6E, 0x07, 0x08, 0x40,
				 0x00, 0x00, 0x30, 0x39, 0x00, (byte)0x9f, 0x4d, 0x02, 0x0B, 0x0A, (byte)0x90 , 0x00} ;

	byte gpo_response[] = { 0x77, 0x0E, (byte) 0x82, 0x02, 0x1B, (byte) 0x80, (byte) 0x94, 0x08, 0x08, 0x01, 0x01, 0x00, 0x10,
				0x01, 0x03, 0x01 , (byte)0x90 , 0x00 } ;

	byte read_record_010C[] = { 0x70, (byte) 0x81, (byte) 0x87, (byte) 0x9F, 0x6C, 0x02, 0x00, 0x01, (byte) 0x9F, 0x62, 0x06,
					0x00, 0x00, 0x00, 0x07, 0x00, 0x00, (byte)0x9F, 0x63, 0x06, 0x00, 0x00, 0x00, 0x78, (byte)0xF0,
					0x00, (byte) 0x9F, 0x64, 0x01, 0x04, 0x56, 0x34, 0x42, 0x35, 0x32, 0x36, 0x31, 0x38, 0x35, 0x31,
					0x30, 0x30, 0x30, 0x30, 0x30, 0x34, 0x30, 0x31, 0x39, 0x5E, 0x20, 0x2F, 0x5E, 0x31, 0x37, 0x31,
					0x30, 0x32, 0x30, 0x31, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
					0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, (byte)0x9F, 0x65, 0x02,
					0x00, (byte)0xE0, (byte)0x9F, 0x66, 0x02, 0x0F, 0x1E, (byte)0x9F, 0x67, 0x01, 0x04, (byte)0x9F,
					0x6B, 0x13, 0x52, 0x61, (byte)0x85, 0x10, 0x00, 0x00, 0x40, 0x19, (byte)0xD1, 0x71, 0x02, 0x01,
					0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, (byte)0x9F, 0x69, 0x0F, (byte)0x9F, 0x6A, 0x04,
					(byte)0x9F, 0x7E, 0x01, (byte)0x9F, 0x02, 0x06, 0x5F, 0x2A, 0x02, (byte)0x9F, 0x1A, 0x02 ,
					(byte)0x90 , 0x00} ;

	byte read_record_0114[] = { 0x70, (byte) 0x81, (byte) 0x9E, 0x57, 0x13, 0x52, 0x61, (byte) 0x85, 0x10, 0x00, 0x00, 0x40,
					0x19, (byte)0xD1, 0x71, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x5A, 0x08, 0x52,
					0x61, (byte)0x85, 0x10, 0x00, 0x00, 0x40, 0x19, 0x5F, 0x24, 0x03, 0x17, 0x10, 0x31, 0x5F, 0x25,
					0x03, 0x14, 0x09, 0x01, 0x5F, 0x28, 0x02, 0x08, 0x40, 0x5F, 0x34, 0x01, 0x00, (byte)0x8C, 0x21,
					(byte) 0x9F, 0x02, 0x06, (byte) 0x9F, 0x03, 0x06, (byte)0x9F, 0x1A, 0x02, (byte)0x95, 0x05, 0x5F,
					0x2A, 0x02, (byte)0x9A, 0x03, (byte)0x9C, 0x01, (byte)0x9F, 0x37, 0x04, (byte)0x9F, 0x35, 0x01,
					(byte)0x9F, 0x45, 0x02, (byte)0x9F, 0x4C, 0x08, (byte)0x9F, 0x34, 0x03, (byte)0x8D, 0x0C,
					(byte)0x91, 0x0A, (byte)0x8A, 0x02, (byte)0x95, 0x05, (byte)0x9F, 0x37, 0x04, (byte)0x9F, 0x4C,
					0x08, (byte)0x8E, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1E, 0x00, 0x1F, 0x00,
					(byte)0x9F, 0x07, 0x02, (byte)0xFF, (byte)0xC0, (byte)0x9F, 0x08, 0x02, 0x00, 0x02, (byte)0x9F,
					0x0D, 0x05, (byte)0xB4, 0x50, (byte)0x84, 0x00, 0x00, (byte)0x9F, 0x0E, 0x05, 0x00, 0x00, 0x00,
					0x00, 0x00, (byte)0x9F, 0x0F, 0x05, (byte)0xB4, 0x70, (byte)0x84, (byte)0x80, 0x00, (byte)0x9F,
					0x42, 0x02, 0x08, 0x40, (byte)0x9F, 0x4A, 0x01, (byte)0x82, (byte)0x90 , 0x00 } ;

	byte read_record_0214[] = { 0x70, (byte)0x81, (byte)0xE0, (byte)0x8F, 0x01, 0x05, (byte)0x9F, 0x32, 0x01, 0x03, (byte)0x92,
    		0x24, 0x24, (byte)0xBE, 0x36, 0x65, 0x4D, (byte)0xCE, 0x7D, (byte)0xCC, (byte)0xD6, 0x38, 0x3D, 0x2B, (byte)0xA6,
    		0x2B, (byte)0x98, (byte)0x92, (byte)0xD0, (byte)0xEA, (byte)0xAB, 0x5D, 0x4A, 0x05, 0x1D, (byte)0xE0, (byte)0xD5,
    		(byte)0x92, (byte)0xE1, 0x12, (byte)0xF8, (byte)0xA9, 0x6F, (byte)0xA1, (byte)0x9A, 0x7B, 0x43, 0x65, (byte)0x90,
    		(byte)0x81, (byte)0xB0, 0x5B, 0x4A, (byte)0xDF, 0x69, (byte)0xAD, (byte)0xA9, 0x08, 0x42, (byte)0xBD, (byte)0xFE,
    		(byte)0xAE, 0x51, 0x5B, (byte)0xC7, (byte)0xC8, (byte)0xDD, (byte)0x8C, (byte)0xCD, (byte)0xDC, 0x22, 0x76,
    		(byte)0x81, 0x1C, 0x69, 0x4F, 0x53, (byte)0xD0, (byte)0xEB, (byte)0xC2, (byte)0xFB, 0x7C, (byte)0xD0, (byte)0xC8,
    		0x03, (byte)0xA0, (byte)0xE9, (byte)0xC9, (byte)0xB4, (byte)0x85, (byte)0xB2, (byte)0x96, (byte)0x9D, 0x64, 0x27,
    		(byte)0xB5, 0x18, (byte)0xF9, 0x42, (byte)0xA8, (byte)0xAD, 0x47, (byte)0xE3, 0x18, (byte)0xAF, 0x03, (byte)0xE2,
    		(byte)0xC4, 0x35, 0x57, 0x13, (byte)0xE6, 0x54, (byte)0xBE, 0x78, (byte)0xCD, 0x56, (byte)0x8D, 0x33, 0x77,
    		(byte)0xEB, 0x54, (byte)0xD8, (byte)0x85, 0x2F, 0x14, (byte)0xBD, (byte)0xCA, 0x7E, 0x59, 0x29, 0x6D, (byte)0xFE,
    		0x34, 0x22, 0x46, (byte)0xFE, 0x07, (byte)0xBA, 0x0F, (byte)0xDC, (byte)0xD1, (byte)0xFB, 0x74, (byte)0xCF, 0x22,
    		0x17, (byte)0xBA, 0x29, (byte)0xE6, 0x64, (byte)0x89, 0x6B, 0x3E, (byte)0x86, (byte)0xFD, (byte)0xC6, 0x2F, 0x10,
    		0x73, (byte)0xB2, (byte)0x80, 0x04, 0x4E, 0x11, 0x30, 0x27, 0x7D, (byte)0xF0, 0x3A, (byte)0xFD, (byte)0x8E,
    		(byte)0xA8, 0x4B, 0x4D, (byte)0xCF, (byte)0xED, (byte)0xBB, 0x1C, (byte)0xFB, 0x6D, 0x4F, (byte)0xD8, 0x79, 0x0C,
    		(byte)0xF4, (byte)0xAA, 0x29, (byte)0xE4, 0x4F, 0x35, (byte)0x95, 0x67, 0x51, 0x6E, (byte)0xE3, 0x40, (byte)0xCE,
    		(byte)0x89, 0x12, (byte)0xD1, 0x70, 0x5E, (byte)0xFD, (byte)0x84, (byte)0xA7, 0x24, 0x52, 0x0D, 0x5F, (byte)0xAB,
    		0x1B, 0x35, 0x03, (byte)0xB9, (byte)0xDA, (byte)0xBA, (byte)0xB8, 0x1C, 0x27, 0x00, (byte)0xF3, 0x49, 0x20,
    		(byte)0x92, (byte)0xAB, 0x5E , (byte)0x90 , 0x00 } ;

	byte read_record_0314[] = { 0x70, (byte)0x81, (byte)0xBB, (byte)0x9F, 0x47, 0x01, 0x03, (byte)0x9F, 0x48, 0x00, (byte)0x9F,
    		0x46, (byte)0x81, (byte)0xB0, 0x74, 0x54, 0x1B, (byte)0xE6, 0x7F, (byte)0xD9, 0x7A, (byte)0xCA, 0x00, 0x0C,
    		(byte)0xAD, 0x22, 0x31, 0x32, (byte)0xC8, (byte)0x86, 0x12, 0x3F, 0x76, 0x35, 0x3F, 0x5D, (byte)0xE3,
    		(byte)0x97, 0x45, 0x68, 0x09, (byte)0x9F, (byte)0xCF, (byte)0xB3, 0x53, 0x26, 0x6D, 0x23, 0x18, 0x0B,
    		(byte)0xCE, 0x1D, (byte)0x82, 0x48, 0x30, (byte)0xEA, (byte)0xF3, 0x64, 0x43, 0x62, 0x30, (byte)0xD6,
    		(byte)0x8F, 0x01, 0x04, (byte)0xF6, (byte)0xA3, 0x76, (byte)0xA4, (byte)0xA2, (byte)0xDB, 0x66, (byte)0xEA,
    		(byte)0xAE, 0x69, 0x52, 0x46, 0x1E, 0x73, 0x0C, 0x62, (byte)0xEC, 0x68, (byte)0xF0, 0x4F, (byte)0xA4, 0x55,
    		(byte)0x94, (byte)0xE3, 0x02, 0x61, 0x07, (byte)0x85, (byte)0xB9, (byte)0xA1, 0x3D, (byte)0x98, (byte)0xEB,
    		(byte)0x81, 0x54, 0x01, 0x55, 0x71, (byte)0xBB, (byte)0x86, 0x39, (byte)0x96, (byte)0xE9, 0x77, (byte)0xE3,
    		(byte)0xBB, 0x41, (byte)0xEA, 0x76, 0x1F, (byte)0xFF, (byte)0x9A, (byte)0xBD, 0x6F, (byte)0x8A, (byte)0x8E,
    		0x62, (byte)0xB7, 0x2F, 0x27, (byte)0xB1, (byte)0xDA, 0x2B, (byte)0xA0, (byte)0xBE, 0x43, (byte)0xC8, 0x7E,
    		0x24, (byte)0xEB, (byte)0xD4, 0x05, 0x6F, (byte)0xE7, (byte)0x8C, (byte)0xEC, (byte)0xD2, 0x5B, (byte)0xC5,
    		(byte)0x9A, (byte)0xCA, (byte)0xA7, 0x7B, 0x1B, 0x5E, (byte)0xF6, (byte)0x83, (byte)0xA8, (byte)0xE6,
    		(byte)0xA5, (byte)0x9C, 0x3E, 0x16, (byte)0xD6, (byte)0xE4, (byte)0xD0, (byte)0xEA, (byte)0xFB, 0x59,
    		(byte)0x97, (byte)0xEF, 0x40, (byte)0xD3, 0x3D, (byte)0xAF, (byte)0x90, (byte)0xA8, (byte)0xB6, (byte)0x8C,
    		0x79, (byte)0xAA, 0x24, 0x24, 0x1D, 0x39, (byte)0x92, 0x5E, 0x6B, (byte)0xF8, 0x2D, 0x0A, (byte)0x82,
    		(byte)0xE0, 0x7A, 0x4B , (byte)0x90 , 0x00};

	byte generate_ac_rep[] = { 0x77, 0x29, (byte)0x9F, 0x27, 0x01, (byte)0x80, (byte)0x9F, 0x36, 0x02, 0x00, 0x71, (byte)0x9F,
    		0x26, 0x08, 0x77, 0x06, (byte)0xEE, (byte)0xA3, (byte)0xE9, (byte)0xA6, (byte)0xAA, 0x37, (byte)0x9F, 0x10, 0x12,
    		0x01, 0x14, (byte)0xA1, 0x00, 0x03, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    		(byte)0xFF , (byte)0x90 , 0x00} ;
	
   
	byte select_c[] = { 0x6F  , 0x3C  , (byte)0x84  , 0x07  , (byte)0xA0  , 0x00  , 0x00  , 0x00  , 0x04  , 0x10  , 0x10,
    		(byte)0xA5  , 0x31  , 0x50  , 0x0A  , 0x4D  , 0x61  , 0x73  , 0x74  , 0x65  , 0x72  , 0x43  , 0x61  , 0x72,
    		0x64  , (byte)0x9F  , 0x38  , 0x06  , (byte)0x9F  , 0x5C  , 0x08  , (byte)0x9F  , 0x40  , 0x05  , (byte)0xBF,
    		0x0C  , 0x19  , (byte)0x9F  , 0x5E  , 0x0B  , 0x54  , 0x13  , 0x33  , (byte)0x90  , 0x00  , 0x00  , 0x15  , 0x13,
    		0x01  , 0x00  , 0x00  , (byte)0x9F  , 0x5D  , 0x03  , 0x01  , 0x01  , 0x00  , (byte)0x9F  , 0x4D  , 0x02  , 0x0B,
    		0x0A  , (byte)0x90  , 0x00} ;
    
	byte gpo_c[] = { 0x77  , 0x12  , (byte)0x82  , 0x02  , 0x79  , 0x00  , (byte)0x94  , 0x0C  , 0x10  , 0x02  , 0x04  , 0x01,
    		0x18  , 0x01  , 0x01  , 0x00  , 0x28  , 0x01  , 0x03  , 0x00  , (byte)0x90  , 0x00 } ;
    
	byte read_record_c0214[] = {0x70  , 0x38  , 0x5F  , 0x24  , 0x03  , 0x12  , 0x12  , 0x31  , 0x5F  , 0x25  , 0x03  , 0x06,
    		0x01  , 0x01  , (byte)0x9F  , 0x07  , 0x02  , (byte)0xFF  , 0x00  , 0x5A  , 0x08  , 0x54  , 0x13  , 0x33, (byte)0x90,
    		0x00  , 0x00  , 0x15  , 0x13  , (byte)0x9F  , 0x0D  , 0x05  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00  , (byte)0x9F,
    		0x0E  , 0x05  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00  , (byte)0x9F  , 0x0F  , 0x05  , 0x00  , 0x00  , 0x00  , 0x00,
    		0x00  , 0x5F  , 0x28  , 0x02  , 0x02  , 0x50  , (byte)0x90  , 0x00} ;
    
	byte read_record_c0314[] = {0x70  , (byte)0x81  , (byte)0x96  , 0x5F  , 0x20  , 0x09  , 0x74  , 0x65  , 0x73  , 0x74  , 0x20,
    		0x63  , 0x61  , 0x72  , 0x64  , (byte)0x8C  , 0x27  , (byte)0x9F  , 0x02  , 0x06  , (byte)0x9F  , 0x03  , 0x06  , (byte)0x9F,
    		0x1A  , 0x02  , (byte)0x95  , 0x05  , 0x5F  , 0x2A  , 0x02  , (byte)0x9A  , 0x03  , (byte)0x9C  , 0x01  , (byte)0x9F  , 0x37,
    		0x04  , (byte)0x9F  , 0x35  , 0x01  , (byte)0x9F  , 0x45  , 0x02  , (byte)0x9F  , 0x4C  , 0x08  , (byte)0x9F  , 0x34  , 0x03,
    		(byte)0x9F  , 0x21  , 0x03  , (byte)0x9F  , 0x7C  , 0x14  , (byte)0x8D  , 0x12  , (byte)0x91  , 0x0A  , (byte)0x8A  , 0x02  ,
    		(byte)0x95  , 0x05  , (byte)0x9F  , 0x37  , 0x04  , (byte)0x9F  , 0x4C  , 0x08  , (byte)0x9F  , 0x02  , 0x06  , (byte)0x9F  ,
    		0x03  , 0x06  , (byte)0x8E  , 0x14  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00  , 0x42  , 0x01  , 0x44  ,
    		0x03  , 0x41  , 0x03  , 0x5E  , 0x03  , 0x42  , 0x03  , 0x1F  , 0x03  , 0x5F  , 0x34  , 0x01  , 0x01  , (byte)0x9F  , 0x42  ,
    		0x02  , 0x09  , 0x78  , (byte)0x9F  , 0x08  , 0x02  , 0x00  , 0x02  , 0x57  , 0x12  , 0x54  , 0x13  , 0x33  , (byte)0x90,
    		0x00  , 0x00  , 0x15  , 0x13  , (byte)0xD1  , 0x21  , 0x22  , 0x01  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00  , 0x00,
    		(byte)0x9F  , 0x51  , 0x03  , (byte)0x9F  , 0x37  , 0x04  , (byte)0x9F  , 0x5B  , 0x0C  , (byte)0xDF  , 0x60  , 0x08,
    		(byte)0xDF  , 0x61  , 0x08  ,  (byte)0xDF  , 0x62  , 0x01  , (byte)0xDF  , 0x63  , (byte)0xA0  , (byte)0x90  , 0x00} ;
    
	byte read_record_c0414[] = {0x70  , (byte)0x81  , (byte)0x93  , (byte)0x93  , (byte)0x81  , (byte)0x90  , 0x37  , (byte)0xB3  , 0x33,
    		0x3A  , 0x6D  , 0x11  , 0x7C  , (byte)0x94  , (byte)0xBB  , 0x6C  , 0x17  , (byte)0x90  , 0x7A  , (byte)0xDE  , (byte)0xD2,
    		0x3F  , (byte)0xD0  , (byte)0xDA  , (byte)0xF2  , 0x6C  , 0x33  , 0x32  , (byte)0x8F  , (byte)0xCE  , 0x70  , 0x50  , 0x32,
    		(byte)0x98  , (byte)0x8D  , (byte)0xD5  , 0x7F  , (byte)0xCD  , (byte)0xB9  , 0x23  , 0x4A  , (byte)0xC8  , 0x4D  , 0x0B,
    		(byte)0xB1  , 0x5B  , (byte)0x94  , (byte)0xB7  , 0x3E  , 0x57  , (byte)0x88  , 0x1A  , 0x18  , 0x3F  , 0x6A  , 0x4F  , 0x03,
    		0x09  , 0x32  , (byte)0xD2  , (byte)0xA0  , 0x1A  , (byte)0xE2  , 0x1D  , 0x7D  , 0x5E  , 0x1E  , (byte)0xCF  , (byte)0xE0,
    		(byte)0xE2  , 0x68  , 0x7A  , (byte)0xD4  , 0x64  , 0x0C  , 0x74  , 0x13  , 0x6D  , 0x36  , 0x60  , 0x14  , 0x39, (byte)0xE7,
    		(byte)0x83  , 0x5C  , (byte)0xF5  , 0x7F  , 0x5E  , (byte)0xB7  , (byte)0xA2  , 0x63  , 0x11  , 0x35  , 0x42  , 0x63,
    		(byte)0xBF  , 0x59  , 0x36  , 0x66  , (byte)0x84  , (byte)0x99  , 0x10  , (byte)0xAA  , 0x19  , (byte)0xE2  , 0x57,
    		(byte)0x90  , 0x50  , (byte)0xFA  , 0x74  , (byte)0xAE  , 0x05  , 0x2E  , 0x6D  , (byte)0xF9  , (byte)0xEB  , (byte)0x8F,
    		(byte)0x94  , 0x05  , (byte)0xD6  , 0x4E  , (byte)0xA1  , 0x3C  , (byte)0xA6  , 0x73  , 0x49  , (byte)0xC2  , 0x41  , 0x72,
    		0x49  , 0x22  , (byte)0xC1  , 0x21  , 0x10  , 0x2B  , (byte)0xA3  , 0x2C  , (byte)0xBD  , (byte)0x9B  , (byte)0xDB,
    		(byte)0xAD  , 0x74  , (byte)0xFD  , (byte)0x89  , (byte)0xCF  , 0x4C  , (byte)0x90  , (byte)0xE2  , (byte)0xD0  , (byte)0xF7,
    		(byte)0xFF  , (byte)0x90  , 0x00} ;
    

	byte read_record_c011c[] = {0x70  , (byte)0x81  , (byte)0xC0  , (byte)0x8F  , 0x01  , (byte)0xF3  , (byte)0x9F  , 0x32  , 0x01  , 0x03,
    		(byte)0x92  , 0x24  , (byte)0xEF  , (byte)0xF4  , (byte)0xA5  , 0x54  , (byte)0xA0  , (byte)0x84  , (byte)0xA8  , 0x29,
    		(byte)0xB0  , (byte)0xD6  , (byte)0xD5  , (byte)0xAC  , (byte)0xCC  , 0x34  , (byte)0xB8  , 0x4C  , 0x26  , 0x2B  , 0x32,
    		0x43  , 0x6A  , (byte)0xBD  , (byte)0xAC  , (byte)0x98  , (byte)0x99  , 0x30  , (byte)0x8D  , 0x51  , (byte)0xE5  , 0x7C,
    		(byte)0x83  , (byte)0xDF  , 0x69  , 0x08  , (byte)0xC3  , (byte)0x89  , (byte)0x90  , (byte)0x81  , (byte)0x90  , 0x7B,
    		(byte)0xFB  , 0x16  , (byte)0xE9  , 0x09  , 0x47  , (byte)0x8D  , (byte)0xBB  , (byte)0x8F  , 0x0C  , (byte)0xE9  , 0x7A,
    		0x28  , 0x11  , (byte)0xB7  , 0x44  , (byte)0x8A  , (byte)0x84  , (byte)0xC6  , (byte)0xD9  , 0x54  , 0x4C  , (byte)0xF5,
    		(byte)0xB1  , (byte)0x8D  , 0x3A  , 0x31  , 0x50  , (byte)0xE1  , (byte)0xA2  , 0x46  , 0x0F  , (byte)0xCE  , (byte)0x86,
    		(byte)0x90  , 0x2D  , 0x6D  , 0x10  , (byte)0x90  , (byte)0x92  , 0x7D  , 0x5D  , 0x78  , 0x59  , (byte)0xCE  , (byte)0xFB,
    		0x7F  , 0x35  , (byte)0x97  , (byte)0xB4  , (byte)0x8B  , 0x23  , 0x51  , 0x76  , (byte)0xEF  , 0x25  , (byte)0x97  ,
    		(byte)0xB6  , (byte)0xD2  , (byte)0xDF  , 0x60  , (byte)0xED  , 0x6C  , 0x24  , (byte)0x93  , 0x3D  , (byte)0xFA  , 0x19,
    		(byte)0xAA  , (byte)0xCA  , 0x38  , 0x72  , (byte)0xE0  , (byte)0x9A  , 0x03  , 0x5C  , 0x50  , (byte)0xF0  , (byte)0xB4  ,
    		(byte)0xE7  , (byte)0xB7  , (byte)0xA1  , 0x74  , 0x06  , (byte)0xD4  , (byte)0x8D  , (byte)0xA5  , (byte)0xDB  , 0x6D  ,
    		0x0E  , (byte)0xE5  , (byte)0xF9  , 0x4A  , (byte)0xE4  , 0x46  , 0x0A  , 0x19  , 0x42  , (byte)0xE3  , (byte)0x8C  ,
    		(byte)0xB5  , 0x6E  , 0x32  , 0x7A  , 0x6F  , (byte)0xC5  , (byte)0xB6  , 0x59  , 0x09  , 0x71  , (byte)0x83  , (byte)0xD3,
    		0x14  , 0x27  , 0x43  , (byte)0x95  , (byte)0x82  , 0x09  , (byte)0x8C  , (byte)0xF9  , 0x05  , (byte)0xDD  , 0x4D  , 0x4B,
    		0x2E  , (byte)0xC2  , 0x10  , 0x57  , 0x0E  , (byte)0xC3  , 0x37  , 0x35  , (byte)0xC6  , (byte)0xEF  , 0x1A  , (byte)0x94,
    		(byte)0xC9  , 0x50  , (byte)0xD3  , 0x5D  , 0x20  , 0x79  , 0x03  , (byte)0x9A  , (byte)0xCF  , (byte)0x90  , 0x00} ;
    
	byte read_record_c012c[] = {0x70  , (byte)0x81  , (byte)0x9E  , (byte)0x9F  , 0x47  , 0x01  , 0x03  , (byte)0x9F  , 0x49  , 0x03,
    		(byte)0x9F  , 0x37, 0x04  , (byte)0x9F  , 0x46  , (byte)0x81  , (byte)0x90  , 0x4C  , 0x66  , (byte)0xCE  , 0x45  ,
    		(byte)0xE0  , 0x0F  , (byte)0xA8  , 0x3A  , 0x15  , 0x53  , 0x66  , 0x7A  , 0x42  , 0x6A  , 0x39  , 0x73  , 0x71  , 0x7C,
    		(byte)0x8F  , (byte)0xFB  , 0x33  , (byte)0xE0  , (byte)0xDB  , (byte)0xE6  , (byte)0xDC  , (byte)0xA0  , (byte)0xA9,
    		(byte)0xDA  , (byte)0x8A  , (byte)0xFC  , 0x1D  , 0x48  , 0x17  , (byte)0xB4  , 0x54  , 0x4C  , 0x31  , 0x6F, (byte)0xFB,
    		0x3B  , (byte)0xF7  , (byte)0xB7  , (byte)0x80  , 0x59  , 0x4A  , (byte)0xBE  , 0x04  , (byte)0x93  , (byte)0xD9  , 0x57,
    		0x10  , 0x05  , (byte)0xE9  , 0x3A  , (byte)0xF9  , 0x6A  , 0x47  , 0x3A  , 0x3A  , (byte)0xAD  , (byte)0xD9, (byte)0x9D,
    		0x07  , (byte)0xDC  , (byte)0xB3  , 0x5C  , (byte)0xDD  , (byte)0xC4  , 0x0E  , 0x66  , (byte)0xE0  , (byte)0xDB,
    		(byte)0xD0  , 0x56  , (byte)0xD9  , (byte)0xB3  , 0x60  , 0x18  , (byte)0xCB  , 0x6B  , (byte)0xE0  , (byte)0xB3  , 0x6D,
    		(byte)0xC8  , 0x0E  , (byte)0xD2  , (byte)0xF3  , (byte)0x8A  , 0x12  , 0x39  , (byte)0xC3  , 0x47  , 0x52  , 0x3F,
    		(byte)0xF5  , (byte)0xF6  , (byte)0x83  , (byte)0xE6  , (byte)0xF4  , 0x0B  , 0x60  , (byte)0xE5  , 0x78,
    		(byte)0xD9  , (byte)0xFE  , (byte)0x97  , 0x75  , (byte)0xA2  , 0x36  , 0x3C  , (byte)0xEC  , (byte)0xFB  , 0x28,
    		(byte)0xEF  , 0x17  , 0x47  , 0x3F  , (byte)0xD3  , 0x5B  , (byte)0xB5  , 0x4D  , 0x21  , 0x79  , (byte)0xFE,
    		(byte)0xCD  , (byte)0xCA  , 0x20  , 0x3D  , 0x4B  , 0x5F  , (byte)0x85  , 0x17  , 0x7B  , (byte)0xF1, (byte)0xF3,
    		(byte)0x8E  , (byte)0xE0  , (byte)0x80  , (byte)0xC6  , 0x3C  , (byte)0xA7  , 0x56  , 0x62  , 0x41  , (byte)0x90,
    		0x00} ;
    
	byte read_record_c022c[] = { 0x70  , 0x21  , (byte)0x9F  , 0x2E  , 0x01  , 0x03  , (byte)0x9F  , 0x2F  , 0x1A  , (byte)0xBC,
			0x02  , 0x31  , 0x25  , (byte)0xAF  , 0x7B  , 0x74  , 0x3B  , (byte)0xEF  , (byte)0xC3  , 0x76  , 0x54  , (byte)0xA2,
			0x4B  , 0x4B  , (byte)0xF5  , (byte)0xA0  , (byte)0xC7  , (byte)0xA9  , (byte)0xE0  , (byte)0xE3  , 0x04  , (byte)0xFA,
			0x3A  , 0x13  , (byte)0xCD  , (byte)0x90  , 0x00} ;
	
	byte read_record_c032c[] = { 0x70  , (byte)0x81  , (byte)0x94  , (byte)0x9F  , 0x2D  , (byte)0x81  , (byte)0x90  , 0x22,
			0x1C  , (byte)0xA5  , (byte)0xF0  , (byte)0x9A  , 0x78  , (byte)0xAF  , 0x2B  , 0x1E  , 0x7D  , 0x5E  , 0x47  , 0x09,
			(byte)0xBE  , 0x4A  , 0x72  , 0x4C  , 0x4E  , (byte)0xBC  , 0x38  , 0x24  , 0x6E  , 0x79  , (byte)0xEC  , 0x2A,
			(byte)0x8F  , 0x78  , 0x7D  , 0x5E  , (byte)0x9E  , (byte)0xFF  , (byte)0xF5  , (byte)0xA1  , (byte)0xB5, (byte)0xF2,
			0x1A  , 0x2D  , 0x0F  , 0x3F  , 0x42  , 0x7D  , 0x5E  , (byte)0xB8  , (byte)0xFC  , 0x54  , (byte)0x8D  , 0x6B, 0x58,
			0x3C  , (byte)0x86  , 0x1A  , (byte)0xF8  , (byte)0x83  , (byte)0x80  , (byte)0xFF  , (byte)0x81  , 0x5A  , (byte)0xEF,
			0x39  , (byte)0x83  , 0x3E  , (byte)0x99  , (byte)0xDA  , 0x05  , 0x22  , 0x42  , 0x28  , (byte)0x97  , 0x56  , 0x74,
			0x49  , (byte)0xCE  , (byte)0x9E  , (byte)0xA8  , 0x1C  , (byte)0xB7  , (byte)0xFC  , (byte)0x9C  , (byte)0xEF,
			(byte)0xF7  , (byte)0xB9  , 0x59  , (byte)0x8D  , (byte)0xFB  , 0x19  , (byte)0x82  , 0x6B  , (byte)0xCC  , (byte)0x97,
			(byte)0x80  , 0x4A  , (byte)0xA2  , 0x56  , (byte)0xE8  , (byte)0xD4  , (byte)0xD0  , (byte)0x82  , (byte)0xE9,
			(byte)0xAF  , (byte)0xFB  , (byte)0xB3  , (byte)0xA7  , 0x2D  , 0x0D  , (byte)0xD6  , (byte)0x88  , (byte)0xA3,
			(byte)0x92  , (byte)0xE0  , 0x24  , (byte)0xB7  , (byte)0x83  , (byte)0xC5  , 0x72  , (byte)0xB6  , 0x6A  , (byte)0x92,
			(byte)0x96  , (byte)0x84  , (byte)0xAF  , 0x4F  , 0x7A  , 0x4C  , (byte)0xAA  , 0x57  , 0x0A  , 0x67  , 0x3B  , 0x0D,
			(byte)0xB6  , (byte)0xA9  , (byte)0x87  , (byte)0xD0  , (byte)0xB0  , (byte)0xB4  , (byte)0xBD  , (byte)0xC8,
			(byte)0x91  , (byte)0xF5  , (byte)0xE4  , 0x73  , 0x3A  , 0x23  , 0x5E  , 0x5B  , (byte)0xFC  , (byte)0x8B,
			(byte)0x90  , 0x00} ;
    
	byte get_data[] =  {(byte)0x9f ,0x17  , 0x01  , 0x03  , (byte)0x90  , 0x00 } ;
   
	byte emv_clear_pin[] = { (byte)0x90  , 0x00 } ;
   
   
	byte generate_ac_rep_c[] = { 0x77  , 0x31  , (byte)0x9F  , 0x27  , 0x01  , 0x40  , (byte)0x9F  , 0x36  , 0x02  , 0x00  ,
		   0x15  , (byte)0x9F  , 0x26  , 0x08  , 0x5D  , (byte)0x81  , 0x4B  , (byte)0xFD  , (byte)0xCD  , 0x39  , (byte)0xFF,
		   0x5A  , (byte)0x9F  , 0x10  , 0x1A  , 0x11  , 0x10  , (byte)0x95  , 0x01  , 0x03  , 0x02  , 0x00  , 0x00  , 0x00,
		   0x00  , 0x00  , 0x00  , 0x00  , 0x00  , 0x06  , (byte)0x94  , 0x13  , (byte)0xFF  , 0x00  , 0x00  , 0x00  , 0x00,
		   0x00  , 0x00  , 0x13  , (byte)0xFF  , (byte)0x90  , 0x00 } ;
    
    
	
	private boolean nfc  ;
	
	public TestCard(boolean nfc){
		this.nfc = nfc ;
	}
	
	
	public byte[] send(byte apdu[]){
		
		if(apdu.length >= 4) {
			
			switch( apdu[1]){
			case (byte)0xA4 :
				Log.i(TAG, "Select " ) ;
				if( apdu[4] == 0x0E  ){
					return select_DF;
				} else if ( apdu[4] == 0x07  ) {
					
					if(nfc){
						Log.d(TAG, "select_response");
						return select_response ;
					}else{
						return select_c ;
					}
				}
				return new byte[] { 0x6A , (byte)0x82 } ;
		
			
			case (byte)0xA8 :
				Log.i(TAG, "GPO : " ) ;
			
			if(nfc){
				Log.d(TAG, "gpo_response");
				return gpo_response ;
			}else{
				return gpo_c ;
			}

			
			case (byte)0xB2 :
				int rec = apdu[2]*0x100 + apdu[3] ;
			
			if(nfc){
				switch( rec ){
				case 0x010C :
					Log.d(TAG, "read_record_010C");
					return read_record_010C;
				case 0x0114 :
					Log.d(TAG, "read_record_0114");
					return read_record_0114;
				case 0x0214 :
					Log.d(TAG, "read_record_0214");
					return read_record_0214;
				case 0x0314 :
					Log.d(TAG, "read_record_0314");
					return read_record_0314;
					
				default :
					return new byte[] { 0x6A , (byte)0x83 } ;
					
				}
			}else{
				switch( rec ){
				case 0x022c :
					return read_record_c022c;
				case 0x032c :
					return read_record_c032c;
				case 0x011c :
					return read_record_c011c;
				case 0x012c :
					return read_record_c012c;
				case 0x0214 :
					return read_record_c0214;
				case 0x0314 :
					return read_record_c0314;
				case 0x0414 :
					return read_record_c0414;
					
				default :
					return new byte[] { 0x6A , (byte)0x83 } ;
				}
			}
			
			case (byte)0xCA :
				Log.d(TAG, "get_data");
				return get_data ;
			
			case (byte)0x20:
				Log.d(TAG, "emv_clear_pin");
				return emv_clear_pin ;
			
				
			case (byte)0xAE :
				if(nfc){
					Log.d(TAG, "generate_ac_resp");
					return generate_ac_rep ;
				}else{
					return generate_ac_rep_c ;
				}
			}		
			
		} else {
			Log.w(TAG, "Unexpected APDU Length");
		}
		
		byte[] successResponse = {(byte)0x6D, (byte)0x00};
		
		return successResponse;
			
	}
	
	
}
